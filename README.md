# heartdetect_model
Пайплайн для прогнозирование риска развития сердечно-сосудистого заболевания пациента

# Хакатон hacks-ai \ Ярославль 2022.

## Кейс: Прогнозирование риска развития сердечно-сосудистого заболевания пациента
## Задача: 
Более 80% смертельных исходов в Российской Федерации связано с заболеваниями Сердечно-сосудистой системы. Клинические методы диагностики не позволяют определять предикторы этих проблем без посещения медицинской организации и взятия анализов. В этой связи особую актуальность приобретает разработка интеллектуальной системы прогнозирования риска развития заболеваний с использованием исторических данных, позволяющей оценить риски критических нарушений в условиях повседневной жизни, без визита к врачу.

Распространенность болезней системы кровообращения преимущественно зависит от причин, главным образом, связанных с особенностями образа жизни, профилактическое воздействие на который может замедлить развитие заболеваний как до, так и после появления клинических симптомов. К настоящему времени выделяют более 300 факторов риска, однако, в первую очередь, сегодня используют семь факторов, вносящих основной̆ вклад в преждевременную смертность: артериальная гипертензия, гиперхолестеринемия, курение, недостаточное потребление фруктов и овощей, избыточная масса тела, избыточное потребление алкоголя, гиподинамия. Это так называемые, традиционные факторы. Если же традиционным факторам уделяется огромное внимание, то нетрадиционным посвящены всего лишь отдельные исследования.

Участникам чемпионата будет предложено проанализировать, как традиционные, так и нетрадиционные факторы риска и построить прогнозную модель развития сердечно-сосудистого заболевания пациента.

Для решения задачи прогнозирования риска заболеваний пациента по нетрадиционным факторам были построены отдельные модели машинного обучения (CatBoost) для каждого из пяти заболеваний, которые необходимо прогнозировать.

На первом этапе были отобраны наиболее информативные переменные, которые в наибольшей степени влияют на наличие заболеваний. После чего было произведено обучения моделей. На финальном этапе для обученных моделей были подобраны оптимальные константы для перевода вещественных предсказаний в бинарные и позволяющие достичь наиольшего значения целевой метрики.

## Что осуществляет пайплайн:
- Приведение лейблов колонок к нормальному виду.
- Приведение текстовых строк к бинарному виду.
- Нормализация датасета.
- Выравнивание несбалансированных классов.
- CatBoost classifier для обучения и предикта.
- Предикт на валидационном датасете.
- 
## Пайплайн:
![alt text](https://github.com/progressionnetwork/heartdetect_model/blob/main/zdrav2.png?raw=true)

===========================================

### Другие решения:

https://github.com/alex-dudin/hacks-ai-heart
https://github.com/6OVNavi/heart_disease_digital_proriv/blob/main/notebook.py
https://github.com/SlayZar/RSV22_yaroslavl_serdce

## Краткое описание решения:

Для решения задачи прогнозирования сердечно-сосудистых заболеваний пациентов были созданы модели на основе LightGBM и TabNet.

Это позволило повысить точность прогнозирования за счет одновременного использования градиентного бустинга и нейронных сетей.
1. На первом шаге производилась очистка и нормализация данных, генерация новых признаков
2. На втором шаге производилось обучение ансамбля моделей LightGBM и TabNet для каждой из болезней
3. На последнего шаге результаты предсказания отдельных моделей объединялись в финальный прогноз


Технические особенности:

Python, TabNet, LightGBM


Уникальность:

Использован ансамбль моделей градиентного бустинга и нейронных сетей.
